---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Calculadora Gastos de Cierre 2026 | M2 Real Estate">
    <div class="bg-gray-50 min-h-screen py-24 relative overflow-hidden">
        <!-- Background Elements -->
        <div class="fixed inset-0 z-0 bg-gray-50"></div>
        <div class="fixed top-0 left-0 h-[500px] w-full bg-gradient-to-b from-white to-transparent z-0"></div>

        <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <h1 class="text-3xl font-serif font-bold text-brand-surface mb-8 text-center animate-fade-in-up">
                Herramientas Fiscales
            </h1>

            <div class="bg-white p-8 rounded-sm shadow-xl shadow-brand-accent/5 border border-gray-100 animate-fade-in-up delay-100">
                <div class="mb-8 border-b border-gray-100 pb-4">
                    <h2 class="font-serif text-2xl text-brand-surface tracking-tight">
                        Estimador de Gastos de Cierre
                    </h2>
                    <p class="text-sm text-gray-500 mt-2">
                        Estime impuestos de traspaso y honorarios legales (Año Fiscal 2026).
                    </p>
                </div>

                <div class="mb-8">
                    <label for="price" class="block text-[10px] font-bold uppercase tracking-widest text-brand-accent mb-2">
                        Valor de Propiedad (USD)
                    </label>
                    <div class="relative">
                        <span class="absolute left-4 top-3 text-gray-400 font-serif">$</span>
                        <input
                            id="price-input"
                            type="number"
                            class="w-full bg-gray-50 border border-gray-200 rounded-sm py-4 pl-8 pr-4 text-brand-surface font-serif text-xl focus:border-brand-accent focus:outline-none focus:ring-1 focus:ring-brand-accent transition-all animate-glow appearance-none"
                            placeholder="0.00"
                        />
                    </div>
                </div>

                <div class="space-y-4 border-t border-gray-100 pt-6 bg-gray-50/50 p-6 rounded-sm">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600 text-sm">Impuesto de Traspaso (1.5%)</span>
                        <span class="font-bold text-brand-surface" id="transfer-tax">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600 text-sm">Honorarios Legales (Est. ~1.25%)</span>
                        <span class="font-bold text-brand-surface" id="legal-fees">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600 text-sm">Timbres Fiscales (~0.8%)</span>
                        <span class="font-bold text-brand-surface" id="stamps">$0.00</span>
                    </div>
                    <div class="border-t border-gray-200 pt-5 flex justify-between items-center mt-4">
                        <span class="font-serif font-bold text-brand-accent text-xl">Total Estimado</span>
                        <span class="font-serif font-bold text-brand-surface text-2xl" id="total-closing">$0.00</span>
                    </div>
                </div>

                <div class="mt-8 text-[10px] text-gray-400 text-center leading-relaxed uppercase tracking-tighter">
                    * Esta calculadora es para fines informativos (Modelo 2026_v1).
                    Los montos exactos deben ser verificados por un Notario Público.
                    M2 Real Estate no se hace responsable por diferencias en el cierre.
                </div>
            </div>
        </div>
    </div>
</Layout>

<script>
    const input = document.getElementById('price-input') as HTMLInputElement;
    const transferTaxEl = document.getElementById('transfer-tax');
    const legalFeesEl = document.getElementById('legal-fees');
    const stampsEl = document.getElementById('stamps');
    const totalClosingEl = document.getElementById('total-closing');

    const formatter = new Intl.NumberFormat("en-US", {
        style: "currency",
        currency: "USD",
        maximumFractionDigits: 0
    });

    if (input) {
        input.addEventListener('input', (e) => {
            const price = parseFloat((e.target as HTMLInputElement).value) || 0;
            
            const transferTax = price * 0.015;
            const legalFees = price * 0.0125;
            const stamps = price * 0.008;
            const total = transferTax + legalFees + stamps;

            if (transferTaxEl) transferTaxEl.innerText = formatter.format(transferTax);
            if (legalFeesEl) legalFeesEl.innerText = formatter.format(legalFees);
            if (stampsEl) stampsEl.innerText = formatter.format(stamps);
            if (totalClosingEl) totalClosingEl.innerText = formatter.format(total);
        });
    }
</script>
